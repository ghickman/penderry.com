#!/usr/bin/env python

import glob
import os

from jinja2 import Environment, FileSystemLoader


OUTPUT_DIR = os.path.join(os.getcwd(), 'output')
PAGE = 'index.html'


def build_painting(filename):
    name, ext = os.path.splitext(filename)
    data = {
        'alt': name,
        'name': filename,
        'thumb': '{}_thumb{}'.format(name, ext),
    }
    return data

paths = filter(lambda x: 'thumb' not in x, glob.iglob('img/tina_lewis_*.jpg'))
files = map(lambda x: os.path.split(x)[1], paths)
paintings = [build_painting(x) for x in files]

env = Environment(loader=FileSystemLoader('templates'))
page = env.get_template(PAGE)
with open(os.path.join(OUTPUT_DIR, PAGE), 'w') as f:
    f.write(page.render(paintings=paintings).encode('utf-8'))
