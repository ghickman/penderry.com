document.write('<link rel="stylesheet" href="http://gist.github.com/stylesheets/gist/embed.css"/>')





document.write('<div id=\"gist-320150\" class=\"gist\">\n  \n  \n    \n            \n            \n            \n            \n            \n\n      <div class=\"gist-file\">\n        <div class=\"gist-data gist-syntax\">\n          \n          \n          \n            <div class=\"gist-highlight\"><pre><div class=\"line\" id=\"LC1\"><span class=\"vg\">$:<\/span><span class=\"o\">.<\/span><span class=\"n\">unshift<\/span><span class=\"p\">(<\/span><span class=\"no\">File<\/span><span class=\"o\">.<\/span><span class=\"n\">dirname<\/span><span class=\"p\">(<\/span><span class=\"bp\">__FILE__<\/span><span class=\"p\">))<\/span><\/div><div class=\"line\" id=\"LC2\"><br/><\/div><div class=\"line\" id=\"LC3\"><span class=\"nb\">require<\/span> <span class=\"s1\">&#39;rubygems&#39;<\/span><\/div><div class=\"line\" id=\"LC4\"><span class=\"nb\">require<\/span> <span class=\"s1\">&#39;open-uri&#39;<\/span><\/div><div class=\"line\" id=\"LC5\"><span class=\"nb\">require<\/span> <span class=\"s1\">&#39;nokogiri&#39;<\/span><\/div><div class=\"line\" id=\"LC6\"><br/><\/div><div class=\"line\" id=\"LC7\"><span class=\"nb\">require<\/span> <span class=\"s1\">&#39;date_helpers&#39;<\/span><\/div><div class=\"line\" id=\"LC8\"><span class=\"kp\">include<\/span> <span class=\"no\">DateHelpers<\/span><\/div><div class=\"line\" id=\"LC9\"><br/><\/div><div class=\"line\" id=\"LC10\"><span class=\"n\">url<\/span> <span class=\"o\">=<\/span> <span class=\"s1\">&#39;http://twitter.com/statuses/user_timeline/14274164.rss&#39;<\/span><\/div><div class=\"line\" id=\"LC11\"><span class=\"n\">filename<\/span> <span class=\"o\">=<\/span> <span class=\"no\">File<\/span><span class=\"o\">.<\/span><span class=\"n\">join<\/span><span class=\"p\">(<\/span><span class=\"no\">File<\/span><span class=\"o\">.<\/span><span class=\"n\">dirname<\/span><span class=\"p\">(<\/span><span class=\"bp\">__FILE__<\/span><span class=\"p\">),<\/span> <span class=\"s1\">&#39;..&#39;<\/span><span class=\"p\">,<\/span> <span class=\"s1\">&#39;_includes&#39;<\/span><span class=\"p\">,<\/span> <span class=\"s1\">&#39;twitter.html&#39;<\/span><span class=\"p\">)<\/span><\/div><div class=\"line\" id=\"LC12\"><br/><\/div><div class=\"line\" id=\"LC13\"><span class=\"n\">doc<\/span> <span class=\"o\">=<\/span> <span class=\"no\">Nokogiri<\/span><span class=\"o\">::<\/span><span class=\"no\">XML<\/span><span class=\"p\">(<\/span><span class=\"nb\">open<\/span><span class=\"p\">(<\/span><span class=\"n\">url<\/span><span class=\"p\">))<\/span><\/div><div class=\"line\" id=\"LC14\"><br/><\/div><div class=\"line\" id=\"LC15\"><span class=\"no\">File<\/span><span class=\"o\">.<\/span><span class=\"n\">open<\/span><span class=\"p\">(<\/span><span class=\"n\">filename<\/span><span class=\"p\">,<\/span> <span class=\"s1\">&#39;w&#39;<\/span><span class=\"p\">)<\/span> <span class=\"k\">do<\/span> <span class=\"o\">|<\/span><span class=\"n\">f<\/span><span class=\"o\">|<\/span><\/div><div class=\"line\" id=\"LC16\">&nbsp;&nbsp;<span class=\"n\">f<\/span><span class=\"o\">.<\/span><span class=\"n\">puts<\/span> <span class=\"s1\">&#39;&lt;ul class=&quot;twitter_feed&quot;&gt;&#39;<\/span><\/div><div class=\"line\" id=\"LC17\">&nbsp;&nbsp;<span class=\"n\">doc<\/span><span class=\"o\">.<\/span><span class=\"n\">xpath<\/span><span class=\"p\">(<\/span><span class=\"s1\">&#39;.//item&#39;<\/span><span class=\"p\">)<\/span><span class=\"o\">.<\/span><span class=\"n\">slice<\/span><span class=\"p\">(<\/span><span class=\"mi\">0<\/span><span class=\"o\">.<\/span><span class=\"n\">.<\/span><span class=\"mi\">5<\/span><span class=\"p\">)<\/span><span class=\"o\">.<\/span><span class=\"n\">each<\/span> <span class=\"k\">do<\/span> <span class=\"o\">|<\/span><span class=\"n\">item<\/span><span class=\"o\">|<\/span><\/div><div class=\"line\" id=\"LC18\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"n\">desc<\/span> <span class=\"o\">=<\/span> <span class=\"n\">item<\/span><span class=\"o\">.<\/span><span class=\"n\">at_xpath<\/span><span class=\"p\">(<\/span><span class=\"s1\">&#39;description&#39;<\/span><span class=\"p\">)<\/span><span class=\"o\">.<\/span><span class=\"n\">text<\/span><\/div><div class=\"line\" id=\"LC19\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"n\">desc<\/span> <span class=\"o\">=<\/span> <span class=\"n\">desc<\/span><span class=\"o\">.<\/span><span class=\"n\">gsub<\/span><span class=\"p\">(<\/span><span class=\"sr\">/(.+): /<\/span><span class=\"p\">,<\/span> <span class=\"s1\">&#39;&#39;<\/span><span class=\"p\">)<\/span><\/div><div class=\"line\" id=\"LC20\"><br/><\/div><div class=\"line\" id=\"LC21\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"n\">link<\/span> <span class=\"o\">=<\/span> <span class=\"n\">item<\/span><span class=\"o\">.<\/span><span class=\"n\">at_xpath<\/span><span class=\"p\">(<\/span><span class=\"s1\">&#39;link&#39;<\/span><span class=\"p\">)<\/span><span class=\"o\">.<\/span><span class=\"n\">text<\/span><\/div><div class=\"line\" id=\"LC22\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"n\">date<\/span> <span class=\"o\">=<\/span> <span class=\"n\">item<\/span><span class=\"o\">.<\/span><span class=\"n\">at_xpath<\/span><span class=\"p\">(<\/span><span class=\"s1\">&#39;pubDate&#39;<\/span><span class=\"p\">)<\/span><span class=\"o\">.<\/span><span class=\"n\">text<\/span><\/div><div class=\"line\" id=\"LC23\"><br/><\/div><div class=\"line\" id=\"LC24\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"c1\"># Skip items that start with @ don&#39;t need those on the site =)<\/span><\/div><div class=\"line\" id=\"LC25\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"k\">unless<\/span> <span class=\"n\">desc<\/span> <span class=\"o\">=~<\/span> <span class=\"sr\">/^@/<\/span><\/div><div class=\"line\" id=\"LC26\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"c1\"># Link up @username<\/span><\/div><div class=\"line\" id=\"LC27\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"n\">desc<\/span><span class=\"o\">.<\/span><span class=\"n\">gsub!<\/span><span class=\"p\">(<\/span><span class=\"sr\">/(?!\\s+)@([A-Za-z0-9_]+)/<\/span><span class=\"p\">,<\/span> <span class=\"s1\">&#39;&lt;a class=&quot;user&quot; href=&quot;http://twitter.com/\\1&quot;&gt;@\\1&lt;/a&gt;&#39;<\/span><span class=\"p\">)<\/span><\/div><div class=\"line\" id=\"LC28\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"c1\"># Link up hashtags.<\/span><\/div><div class=\"line\" id=\"LC29\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"n\">desc<\/span><span class=\"o\">.<\/span><span class=\"n\">gsub!<\/span><span class=\"p\">(<\/span><span class=\"sr\">/#([A-Za-z0-9_]+)/<\/span><span class=\"p\">,<\/span><\/div><div class=\"line\" id=\"LC30\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"s1\">&#39;&lt;a class=&quot;hash&quot; href=&quot;http://twitter.com/#search?q=%23\\1&quot;&gt;#\\1&lt;/a&gt;&#39;<\/span><span class=\"p\">)<\/span><\/div><div class=\"line\" id=\"LC31\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"c1\"># Finally convert new lines to br&#39;s<\/span><\/div><div class=\"line\" id=\"LC32\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"n\">desc<\/span><span class=\"o\">.<\/span><span class=\"n\">gsub!<\/span><span class=\"p\">(<\/span><span class=\"sr\">/\\n/<\/span><span class=\"p\">,<\/span> <span class=\"s1\">&#39;&lt;br /&gt;&#39;<\/span><span class=\"p\">)<\/span><\/div><div class=\"line\" id=\"LC33\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"n\">f<\/span><span class=\"o\">.<\/span><span class=\"n\">puts<\/span> <span class=\"sx\">%Q{<\/span><span class=\"se\">\\t<\/span><span class=\"sx\">&lt;li&gt;<\/span><span class=\"si\">#{<\/span><span class=\"n\">desc<\/span><span class=\"si\">}<\/span><span class=\"sx\"> &lt;a href=&quot;<\/span><span class=\"si\">#{<\/span><span class=\"n\">link<\/span><span class=\"si\">}<\/span><span class=\"sx\">&quot;&gt;<\/span><span class=\"si\">#{<\/span><span class=\"n\">time_ago_in_words<\/span><span class=\"p\">(<\/span><span class=\"no\">Time<\/span><span class=\"o\">.<\/span><span class=\"n\">parse<\/span><span class=\"p\">(<\/span><span class=\"n\">date<\/span><span class=\"p\">))<\/span><span class=\"si\">}<\/span><span class=\"sx\"> ago&lt;/a&gt;&lt;/li&gt;}<\/span><\/div><div class=\"line\" id=\"LC34\">&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"k\">end<\/span><\/div><div class=\"line\" id=\"LC35\">&nbsp;&nbsp;<span class=\"k\">end<\/span><\/div><div class=\"line\" id=\"LC36\">&nbsp;&nbsp;<span class=\"n\">f<\/span><span class=\"o\">.<\/span><span class=\"n\">puts<\/span> <span class=\"s1\">&#39;&lt;/ul&gt;&#39;<\/span><\/div><div class=\"line\" id=\"LC37\"><span class=\"k\">end<\/span><\/div><\/pre><\/div>\n          \n        <\/div>\n\n        <div class=\"gist-meta\">\n          <a href=\"http://gist.github.com/raw/320150/ee2f2c2b9cbf6529821b56d11d2b7e32172342b5/twitter.rb\" style=\"float:right;\">view raw<\/a>\n          <a href=\"http://gist.github.com/320150#file_twitter.rb\" style=\"float:right;margin-right:10px;color:#666\">twitter.rb<\/a>\n          <a href=\"http://gist.github.com/320150\">This Gist<\/a> brought to you by <a href=\"http://github.com\">GitHub<\/a>.\n        <\/div>\n      <\/div>\n    \n  \n<\/div>\n')
